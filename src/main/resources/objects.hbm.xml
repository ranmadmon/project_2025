<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping>

    <!-- Role Entity -->
    <class name="com.ashcollege.entities.RoleEntity" table="roles" lazy="false">
        <id name="id" type="int" column="id">
            <generator class="native"/>
        </id>
        <property name="name" type="string" column="name"/>
    </class>

    <!-- User Entity -->
    <class name="com.ashcollege.entities.UserEntity" table="users" lazy="false">
        <id name="id" type="int" column="id">
            <generator class="native"/>
        </id>
        <property name="username" type="string" column="username"/>
        <property name="password" type="string" column="password"/>
        <property name="firstName" type="string" column="first_name"/>
        <property name="lastName" type="string" column="last_name"/>
        <property name="email" type="string" column="email"/>
        <property name="phoneNumber" type="string" column="phone"/>
        <property name="otp" type="string" column="otp"/>
        <property name="passwordRecovery" type="string" column="pass_recovery"/>
        <many-to-one name="role" column="role_id" class="com.ashcollege.entities.RoleEntity"/>
        <property name="teamId" type="int" column="team_id"/>
        <property name="status" type="string" column="status"/>

    </class>

    <!-- Ability Entity -->
    <class name="com.ashcollege.entities.AbilityEntity" table="abilities" lazy="false">
        <id name="id" type="int" column="id">
            <generator class="native"/>
        </id>
        <property name="name" type="string" column="name"/>
    </class>

    <!-- Task Entity -->
    <class name="com.ashcollege.entities.TaskEntity" table="tasks" lazy="false">
        <id name="id" type="int" column="id">
            <generator class="native"/>
        </id>
        <property name="name" type="string" column="name"/>
        <property name="averageTime" type="int" column="average_time"/>
        <property name="status" type="string" column="status" not-null="true" length="20"/>

    </class>

    <!-- Client Entity -->
    <class name="com.ashcollege.entities.ClientEntity" table="clients" lazy="false">
        <id name="id" type="int" column="id">
            <generator class="native"/>
        </id>
        <property name="name" type="string" column="name"/>
        <many-to-one name="manager" class="com.ashcollege.entities.UserEntity" column="manager_id"/>
        <property name="status" type="string" column="status" not-null="true" length="20"/>
    </class>


    <!-- TaskRequirement Entity -->
    <class name="com.ashcollege.entities.TaskRequirementEntity" table="task_requirements" lazy="false">
            <id name="taskId" column="task_id" type="int"/>
        <property name="abilities" column="abilities" type="string"/>
    </class>

    <!-- UserAbility Entity -->
    <class name="com.ashcollege.entities.UserAbilityEntity" table="user_abilities" lazy="false">
        <id name="userId" column="user_id" type="int"/>
        <property name="abilities" column="abilities" type="string"/>
    </class>

    <!-- Team Entity -->
    <class name="com.ashcollege.entities.TeamEntity" table="teams" lazy="false">
        <id name="id" type="int" column="id">
            <generator class="native"/>
        </id>
        <property name="name" type="string" column="name"/> <!-- 🆕 שם הצוות -->
        <many-to-one name="head" column="head_id" class="com.ashcollege.entities.UserEntity"/>
    </class>


    <!-- TeamMember Entity -->
    <class name="com.ashcollege.entities.TeamMemberEntity" table="team_members" lazy="false">
        <composite-id>
            <key-property name="teamId" column="team_id" type="int"/>
            <key-property name="userId" column="user_id" type="int"/>
        </composite-id>
    </class>

    <!-- TaskAssignment Entity -->
    <class name="com.ashcollege.entities.TaskAssignmentEntity" table="task_assignments" lazy="false">
        <id name="id" type="int" column="id">
            <generator class="native"/>
        </id>
        <many-to-one name="task"   column="task_id"   class="com.ashcollege.entities.TaskEntity"/>
        <many-to-one name="client" column="client_id" class="com.ashcollege.entities.ClientEntity"/>
        <!-- השדה 'user' שנותר כ'בעל המשימה' -->
        <many-to-one name="user"   column="user_id"   class="com.ashcollege.entities.UserEntity"/>
        <property   name="hours" column="hours_required" type="int"/>
        <property   name="status"        column="status"         type="string"/>
        <property   name="assignedDate"  column="assigned_date"  type="date"/>
    </class>
    <!-- TaskAssignment Entity -->
    <class name="com.ashcollege.entities.AssignmentParticipantEntity" table="assignmentParticipantEntity" lazy="false">
        <id name="id" type="int" column="id">
            <generator class="native"/>
        </id>
        <many-to-one name="task"   column="task_id"   class="com.ashcollege.entities.TaskAssignmentEntity"/>
        <many-to-one name="user"   column="user_id"   class="com.ashcollege.entities.UserEntity"/>
        <property   name="hours" column="hours_assigned" type="int"/>
    </class>

</hibernate-mapping>
